import{bB as vs,bC as e,r as i,bD as Et,bE as Cs,bF as Ts,bG as Is,bH as ks,bI as he,bJ as Ls,bK as As,bL as Tt,bM as Ns,bN as Fs,bO as Rs,bP as Ps,bQ as Es,bR as Ms,bS as Us,bT as Os,bU as Bs,bV as It}from"./vendor-5ba33fe3.js";import{e as qs,E as Vs,M as kt,f as Gs,g as $s,D as Mt,h as Ds}from"./fluentui-icons-8f811f5c.js";import{I as W,S as j,P as Hs,T as Me,B as J,a as $,u as zs,b as m,C as Ut,D as qe,c as Qs,d as Ks,M as Ws,e as Js,L as Xs,f as Ys,g as Re,h as Ot,i as re,j as Ue,k as Lt,l as Zs,m as en,n as At,o as tn,p as sn,q as nn,r as Q,s as on}from"./fluentui-react-af2542d5.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();const an="_container_6tb62_1",rn="_chatRoot_6tb62_55",ln="_chatContainer_6tb62_65",cn="_chatEmptyState_6tb62_85",dn="_chatEmptyStateTitle_6tb62_105",un="_chatEmptyStateSubtitle_6tb62_121",hn="_chatMessageStream_6tb62_133",pn="_chatMessageGpt_6tb62_171",mn="_chatMessageGptMinWidth_6tb62_183",gn="_chatInput_6tb62_193",xn="_chatAnalysisPanel_6tb62_215",fn="_chatSettingsSeparator_6tb62_231",bn="_loadingLogo_6tb62_243",Sn="_commandsContainer_6tb62_251",_n="_commandButton_6tb62_265",f={container:an,chatRoot:rn,chatContainer:ln,chatEmptyState:cn,chatEmptyStateTitle:dn,chatEmptyStateSubtitle:un,chatMessageStream:hn,chatMessageGpt:pn,chatMessageGptMinWidth:mn,chatInput:gn,chatAnalysisPanel:xn,chatSettingsSeparator:fn,loadingLogo:bn,commandsContainer:Sn,commandButton:_n},yn=".auth/me",wn=".auth/refresh",jn=".auth/logout?post_logout_redirect_uri=/";async function vn(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const V=await vn();console.log("MSAL Configuration:",V.msalConfig);V.useLogin=!0;V.requireAccessControl=!0;const ce=V.requireAccessControl,Cn=V.enableUnauthenticatedAccess,Nt=ce&&!Cn,Tn=V.msalConfig,In=V.loginRequest,kn=V.tokenRequest,Bt=()=>window.location.origin+V.msalConfig.auth.redirectUri;globalThis.cachedAppServicesToken=null;const pe=()=>{const t=n=>{const r=new Date;return new Date(n.expires_on)>r};if(globalThis.cachedAppServicesToken&&t(globalThis.cachedAppServicesToken))return Promise.resolve(globalThis.cachedAppServicesToken);const s=()=>fetch(yn).then(n=>n.ok?n.json().then(r=>r.length>0?{id_token:r[0].id_token,access_token:r[0].access_token,user_claims:r[0].user_claims.reduce((a,l)=>(a[l.typ]=l.val,a),{}),expires_on:r[0].expires_on}:null):null);return s().then(n=>n?t(n)?(globalThis.cachedAppServicesToken=n,n):fetch(wn).then(r=>r.ok?s():null):null)},Ln=await pe()!=null,An=()=>{window.location.href=jn},Oe=async t=>!!(t&&t.getActiveAccount()||await pe()),de=async t=>{const s=await pe();return s?Promise.resolve(s.access_token):t.acquireTokenSilent({...kn,redirectUri:Bt()}).then(n=>n.accessToken).catch(n=>{console.log(n)})},Pe=async t=>{const s=t.getActiveAccount();if(s)return s.username;const n=await pe();return n?.user_claims?n.user_claims.preferred_username:null},Nn=async t=>{const s=t.getActiveAccount();if(s)return s.idTokenClaims;const n=await pe();if(n)return n.user_claims},we="";async function Z(t){return!Ln&&t?{Authorization:`Bearer ${t}`}:{}}async function Fn(){return await(await fetch(`${we}/config`,{method:"GET"})).json()}async function Ua(t,s){const n=await Z(s),r=await fetch(`${we}/ask`,{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await r.json();if(r.status>299||!r.ok)throw Error(a.error||"Unknown error");return a}async function Rn(t,s,n){let r=`${we}/chat`;s&&(r+="/stream");const a=await Z(n);return await fetch(r,{method:"POST",headers:{...a,"Content-Type":"application/json"},body:JSON.stringify(t)})}async function Pn(t){return await fetch("/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})}).then(s=>s.status==200?s.blob():s.status==400?(console.log("Speech synthesis is not enabled."),null):(console.error("Unable to get speech synthesis."),null)).then(s=>s?URL.createObjectURL(s):null)}function qt(t){return`${we}/content/${t}`}async function En(t,s){const n=await fetch("/upload",{method:"POST",headers:await Z(s),body:t});if(!n.ok)throw new Error(`Uploading files failed: ${n.statusText}`);return await n.json()}async function Mn(t,s){const n=await Z(s),r=await fetch("/delete_uploaded",{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({filename:t})});if(!r.ok)throw new Error(`Deleting file failed: ${r.statusText}`);return await r.json()}async function Un(t){const s=await fetch("/list_uploaded",{method:"GET",headers:await Z(t)});if(!s.ok)throw new Error(`Listing files failed: ${s.statusText}`);return await s.json()}var A=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(A||{}),D=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(D||{}),M=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(M||{});const On="_answerContainer_1lpt6_1",Bn="_answerLogo_1lpt6_21",qn="_answerText_1lpt6_29",Vn="_selected_1lpt6_67",Gn="_citationLearnMore_1lpt6_75",$n="_citation_1lpt6_75",Dn="_followupQuestionsList_1lpt6_119",Hn="_followupQuestionLearnMore_1lpt6_127",zn="_followupQuestion_1lpt6_119",Qn="_supContainer_1lpt6_165",Kn="_retryButton_1lpt6_223",Wn="_loadingdots_1lpt6_267",Jn="_loading_1lpt6_267",N={answerContainer:On,answerLogo:Bn,answerText:qn,selected:Vn,citationLearnMore:Gn,citation:$n,followupQuestionsList:Dn,followupQuestionLearnMore:Hn,followupQuestion:zn,supContainer:Qn,retryButton:Kn,loadingdots:Wn,loading:Jn};function Xn(t,s,n){const r=[];let a=t.trim();if(s){let c=a.length;for(let p=a.length-1;p>=0&&a[p]!=="]";p--)if(a[p]==="["){c=p;break}a=a.substring(0,c)}return{answerHtml:a.split(/\[([^\]]+)\]/g).map((c,u)=>{if(u%2===0)return c;{let p;r.indexOf(c)!==-1?p=r.indexOf(c)+1:(r.push(c),p=r.length);const S=qt(c);return vs(e.jsx("a",{className:"supContainer",title:c,onClick:()=>n(S),children:e.jsx("sup",{children:p})}))}}).join(""),citations:r}}const Vt=()=>e.jsx(qs,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Yn=window.speechSynthesis||window.webkitSpeechSynthesis;let K=null;try{K=Yn}catch{console.error("SpeechSynthesis is not supported")}const Zn=function(t){if(K){const s=new SpeechSynthesisUtterance(t);return s.lang="en-US",s.volume=1,s.rate=1,s.pitch=1,s.voice=K.getVoices().filter(n=>n.lang==="en-US")[0],s}},eo=({answer:t})=>{const[s,n]=i.useState(!1),r=l=>{if(K!=null){if(s){K.cancel(),n(!1);return}const h=Zn(l);if(!h)return;K.speak(h),h.onstart=()=>{n(!0)},h.onend=()=>{n(!1)}}},a=s?"red":"black";return e.jsx(W,{style:{color:a},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>r(t),disabled:!K})};let _e=new Audio;const to=({url:t})=>{const[s,n]=i.useState(!1),r=async()=>{if(s){_e.pause(),n(!1);return}if(!t){console.error("Speech output is not yet available.");return}_e=new Audio(t),await _e.play(),_e.addEventListener("ended",()=>{n(!1)}),n(!0)},a=s?"red":"black";return e.jsx(W,{style:{color:a},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>r(),disabled:!t})},Ft=({answer:t,isSelected:s,isStreaming:n,onCitationClicked:r,onThoughtProcessClicked:a,onSupportingContentClicked:l,onFollowupQuestionClicked:h,showFollowupQuestions:c,showSpeechOutputAzure:u,showSpeechOutputBrowser:p,speechUrl:S})=>{const _=t.context?.followup_questions,y=t.message.content,w=i.useMemo(()=>Xn(y,n,r),[t]),g=Et.sanitize(w.answerHtml);return e.jsxs(j,{className:`${N.answerContainer} ${s&&N.selected}`,verticalAlign:"space-between",children:[e.jsx(j.Item,{children:e.jsxs(j,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(Vt,{}),e.jsxs("div",{children:[e.jsx(W,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>a(),disabled:!t.context.thoughts?.length}),e.jsx(W,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>l(),disabled:!t.context.data_points}),u&&e.jsx(to,{url:S}),p&&e.jsx(eo,{answer:g})]})]})}),e.jsx(j.Item,{grow:!0,children:e.jsx("div",{className:N.answerText,dangerouslySetInnerHTML:{__html:g}})}),!!w.citations.length&&e.jsx(j.Item,{children:e.jsxs(j,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:N.citationLearnMore,children:"Citations:"}),w.citations.map((x,v)=>{const G=qt(x);return e.jsx("a",{className:N.citation,title:x,onClick:()=>r(G),children:`${++v}. ${x}`},v)})]})}),!!_?.length&&c&&h&&e.jsx(j.Item,{children:e.jsxs(j,{horizontal:!0,wrap:!0,className:`${w.citations.length?N.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:N.followupQuestionLearnMore,children:"Follow-up questions:"}),_.map((x,v)=>e.jsx("a",{className:N.followupQuestion,title:x,onClick:()=>h(x),children:`${x}`},v))]})})]})},so=()=>{const t=Cs({from:{opacity:0},to:{opacity:1}});return e.jsx(Ts.div,{style:{...t},children:e.jsxs(j,{className:N.answerContainer,verticalAlign:"space-between",children:[e.jsx(Vt,{}),e.jsx(j.Item,{grow:!0,children:e.jsxs("p",{className:N.answerText,children:["Generating answer",e.jsx("span",{className:N.loadingdots})]})})]})})},no=({error:t,onRetry:s})=>e.jsxs(j,{className:N.answerContainer,verticalAlign:"space-between",children:[e.jsx(Vs,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(j.Item,{grow:!0,children:e.jsx("p",{className:N.answerText,children:t})}),e.jsx(Hs,{className:N.retryButton,onClick:s,text:"Retry"})]}),oo="_questionInputContainer_2j32c_1",ao="_questionInputTextArea_2j32c_21",ro="_questionInputButtonsContainer_2j32c_31",ue={questionInputContainer:oo,questionInputTextArea:ao,questionInputButtonsContainer:ro},io=window.speechRecognition||window.webkitSpeechRecognition;let L=null;try{L=new io,L!=null&&(L.lang="en-US",L.interimResults=!0)}catch{console.error("SpeechRecognition not supported"),L=null}const lo=({updateQuestion:t})=>{const[s,n]=i.useState(!1),r=()=>{if(L==null){console.error("SpeechRecognition not supported");return}L.onresult=l=>{let h="";for(const c of l.results)h+=c[0].transcript;t(h)},L.onend=()=>{n(!1)},L.onerror=l=>{L&&(L.stop(),l.error=="no-speech"?alert("No speech was detected. Please check your system audio settings and try again."):l.error=="language-not-supported"?alert(`Speech recognition error detected: ${l.error}. The speech recognition input functionality does not yet work on all browsers, like Edge in Mac OS X with ARM chips. Try another browser/OS.`):alert(`Speech recognition error detected: ${l.error}.`))},n(!0),L.start()},a=()=>{if(L==null){console.error("SpeechRecognition not supported");return}L.stop(),n(!1)};return L==null?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[!s&&e.jsx("div",{className:ue.questionInputButtonsContainer,children:e.jsx(Me,{content:"Ask question with voice",relationship:"label",children:e.jsx(J,{size:"large",icon:e.jsx(kt,{primaryFill:"rgba(115, 118, 225, 1)"}),onClick:r})})}),s&&e.jsx("div",{className:ue.questionInputButtonsContainer,children:e.jsx(Me,{content:"Stop recording question",relationship:"label",children:e.jsx(J,{size:"large",icon:e.jsx(kt,{primaryFill:"rgba(250, 0, 0, 0.7)"}),disabled:!s,onClick:a})})})]})},je=i.createContext({loggedIn:!1,setLoggedIn:t=>{}}),co=({onSend:t,disabled:s,placeholder:n,clearOnSend:r,initQuestion:a,showSpeechInput:l})=>{const[h,c]=i.useState(""),{loggedIn:u}=i.useContext(je);i.useEffect(()=>{a&&c(a)},[a]);const p=()=>{s||!h.trim()||(t(h),r&&c(""))},S=g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),p())},_=(g,x)=>{x?x.length<=1e3&&c(x):c("")},y=Nt&&!u,w=s||!h.trim()||Nt;return y&&(n="Please login to continue..."),e.jsxs(j,{horizontal:!0,className:ue.questionInputContainer,children:[e.jsx($,{className:ue.questionInputTextArea,disabled:y,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:h,onChange:_,onKeyDown:S}),e.jsx("div",{className:ue.questionInputButtonsContainer,children:e.jsx(Me,{content:"Submit question",relationship:"label",children:e.jsx(J,{size:"large",icon:e.jsx(Gs,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:w,onClick:p})})}),l&&e.jsx(lo,{updateQuestion:c})]})},uo="_examplesNavList_1mhan_1",ho="_example_1mhan_1",po="_exampleText_1mhan_55",Be={examplesNavList:uo,example:ho,exampleText:po},mo=({text:t,value:s,onClick:n})=>e.jsx("div",{className:Be.example,onClick:()=>n(s),children:e.jsx("p",{className:Be.exampleText,children:t})}),go=["What is the next month`s markerting campaign?","How do I register new staff member onto Fernwood Masterclass?","How do I access my Talkbox account?"],xo=["Compare the impact of interest rates and GDP in financial markets.","How do I register new staff member onto Fernwood Masterclass?","How do I access my Talkbox account?"],fo=({onExampleClicked:t,useGPT4V:s})=>e.jsx("ul",{className:Be.examplesNavList,children:(s?xo:go).map((n,r)=>e.jsx("li",{children:e.jsx(mo,{text:n,value:n,onClick:t})},r))}),bo="_container_16z3p_1",So="_message_16z3p_17",Rt={container:bo,message:So},ye=({message:t})=>e.jsx("div",{className:Rt.container,children:e.jsx("div",{className:Rt.message,children:t})}),Pt={childrenGap:4,maxWidth:300},_o={root:{padding:20}},yo={root:{marginBottom:-3}},wo={iconName:"Info"},C=t=>{const[s,{toggle:n}]=zs(!1),r=m("description"),a=m("iconButton");return e.jsxs(e.Fragment,{children:[e.jsxs(j,{horizontal:!0,verticalAlign:"center",tokens:Pt,children:[e.jsx("label",{id:t.labelId,htmlFor:t.fieldId,children:t.label}),e.jsx(W,{id:a,iconProps:wo,title:"Info",ariaLabel:"Info",onClick:n,styles:yo})]}),s&&e.jsx(Ut,{target:"#"+a,setInitialFocus:!0,onDismiss:n,ariaDescribedBy:r,role:"alertdialog",children:e.jsxs(j,{tokens:Pt,horizontalAlign:"start",styles:_o,children:[e.jsx("span",{id:r,children:t.helpText}),e.jsx(qe,{onClick:n,children:"Close"})]})})]})},jo="_thoughtProcess_j4orz_1",vo="_tList_j4orz_15",Co="_tListItem_j4orz_27",To="_tStep_j4orz_79",Io="_tCodeBlock_j4orz_93",ko="_tProp_j4orz_101",Lo="_citationImg_j4orz_119",Y={thoughtProcess:jo,tList:vo,tListItem:Co,tStep:To,tCodeBlock:Io,tProp:ko,citationImg:Lo};function Ao(t){const s=t.split(": "),n=s[0],r=Et.sanitize(s.slice(1).join(": "));return{title:n,content:r}}const No="_supportingContentNavList_1s8d9_1",Fo="_supportingContentItem_1s8d9_17",Ro="_supportingContentItemHeader_1s8d9_43",Po="_supportingContentItemText_1s8d9_51",Eo="_supportingContentItemImage_1s8d9_61",ie={supportingContentNavList:No,supportingContentItem:Fo,supportingContentItemHeader:Ro,supportingContentItemText:Po,supportingContentItemImage:Eo},Mo=({supportingContent:t})=>{const s=Array.isArray(t)?t:t.text,n=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:ie.supportingContentNavList,children:[s.map((r,a)=>{const l=Ao(r);return e.jsxs("li",{className:ie.supportingContentItem,children:[e.jsx("h4",{className:ie.supportingContentItemHeader,children:l.title}),e.jsx("p",{className:ie.supportingContentItemText,dangerouslySetInnerHTML:{__html:l.content}})]},a)}),n?.map((r,a)=>e.jsx("img",{className:ie.supportingContentItemImage,src:r.url},a))]})};var B=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(B||{});const Uo=({thoughts:t})=>e.jsx("ul",{className:Y.tList,children:t.map((s,n)=>e.jsxs("li",{className:Y.tListItem,children:[e.jsx("div",{className:Y.tStep,children:s.title}),e.jsx(j,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(r=>e.jsxs("span",{className:Y.tProp,children:[r,": ",JSON.stringify(s.props?.[r])]}))}),Array.isArray(s.description)?e.jsx(Is,{language:"json",wrapLongLines:!0,className:Y.tCodeBlock,children:JSON.stringify(s.description,null,2)}):e.jsx("div",{children:s.description})]},n))}),Oo="_downloadButton_11qw1_1",Bo="_markdownViewer_11qw1_11",qo="_loading_11qw1_29",Vo="_error_11qw1_41",Go="_markdown_11qw1_11",z={downloadButton:Oo,markdownViewer:Bo,loading:qo,error:Vo,markdown:Go},$o=({src:t})=>{const[s,n]=i.useState(""),[r,a]=i.useState(!0),[l,h]=i.useState(null),c=u=>{const p=/<a\s+(?:[^>]*?\s+)?href=['"](#[^"']*?)['"][^>]*?>/g;return u.replace(p,"")};return i.useEffect(()=>{(async()=>{try{const p=await fetch(t);if(!p.ok)throw new Error("Failed loading markdown file.");const S=await p.text(),_=await ks.parse(S),y=c(_);n(y)}catch(p){h(p)}finally{a(!1)}})()},[t]),e.jsx("div",{children:r?e.jsx("div",{className:`${z.loading} ${z.markdownViewer}`,children:e.jsx(Qs,{size:Ks.large,label:"Loading file"})}):l?e.jsx("div",{className:`${z.error} ${z.markdownViewer}`,children:e.jsxs(Ws,{messageBarType:Js.error,isMultiline:!1,children:[l.message,e.jsx(Xs,{href:t,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(W,{className:z.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:"Save",ariaLabel:"Save",href:t,download:!0}),e.jsx("div",{className:`${z.markdown} ${z.markdownViewer}`,dangerouslySetInnerHTML:{__html:s}})]})})},Ee={disabled:!0,style:{color:"grey"}},Do=({answer:t,activeTab:s,activeCitation:n,citationHeight:r,className:a,onActiveTabChanged:l})=>{const h=!t.context.thoughts,c=!t.context.data_points,u=!n,[p,S]=i.useState(""),_=he().instance,y=async()=>{const g=_?await de(_):void 0;if(n){const x=n.indexOf("#")?n.split("#")[1]:"",G=await(await fetch(n,{method:"GET",headers:await Z(g)})).blob();let U=URL.createObjectURL(G);x&&(U+="#"+x),S(U)}};i.useEffect(()=>{y()},[]);const w=()=>{if(!n)return null;switch(n.split(".").pop()?.toLowerCase()){case"png":return e.jsx("img",{src:p,className:Y.citationImg,alt:"Citation Image"});case"md":return e.jsx($o,{src:n});default:return e.jsx("iframe",{title:"Citation",src:p,width:"100%",height:r})}};return e.jsxs(Ys,{className:a,selectedKey:s,onLinkClick:g=>g&&l(g.props.itemKey),children:[e.jsx(Re,{itemKey:B.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:h?Ee:void 0,children:e.jsx(Uo,{thoughts:t.context.thoughts||[]})}),e.jsx(Re,{itemKey:B.SupportingContentTab,headerText:"Supporting content",headerButtonProps:c?Ee:void 0,children:e.jsx(Mo,{supportingContent:t.context.data_points})}),e.jsx(Re,{itemKey:B.CitationTab,headerText:"Citation",headerButtonProps:u?Ee:void 0,children:w()})]})},Ho="_container_nwwgz_1",zo={container:Ho},Qo=({className:t,onClick:s})=>e.jsx("div",{className:`${zo.container} ${t??""}`,children:e.jsx(J,{icon:e.jsx($s,{}),onClick:s,children:"Developer settings"})}),Ko="_container_nwwgz_1",Wo={container:Ko},Jo=({className:t,disabled:s,onClick:n})=>e.jsx("div",{className:`${Wo.container} ${t??""}`,children:e.jsx(J,{icon:e.jsx(Mt,{}),disabled:s,onClick:n,children:"Clear chat"})}),Xo="_container_5ljyb_1",Yo="_callout_5ljyb_17",Zo="_list_5ljyb_27",ea="_item_5ljyb_39",le={container:Xo,callout:Yo,list:Zo,item:ea},ta=({className:t,disabled:s})=>{const[n,r]=i.useState(!1),[a,l]=i.useState(!1),[h,c]=i.useState(!0),[u,p]=i.useState({}),[S,_]=i.useState(),[y,w]=i.useState(),[g,x]=i.useState([]),v=he().instance,G=async()=>{r(!n);try{const b=await de(v);if(!b)throw new Error("No authentication token available");U(b)}catch(b){console.error(b),c(!1)}},U=async b=>{Un(b).then(k=>{c(!1),p({}),x(k)})},ve=async b=>{p({...u,[b]:"pending"});try{const k=await de(v);if(!k)throw new Error("No authentication token available");await Mn(b,k),p({...u,[b]:"success"}),U(k)}catch(k){p({...u,[b]:"error"}),console.error(k)}},me=async b=>{if(b.preventDefault(),!b.target.files||b.target.files.length===0)return;l(!0);const k=b.target.files[0],ge=new FormData;ge.append("file",k);try{const O=await de(v);if(!O)throw new Error("No authentication token available");const Ce=await En(ge,O);_(Ce),l(!1),w(void 0),U(O)}catch(O){console.error(O),l(!1),w("Error uploading file - please try again or contact admin.")}};return e.jsx("div",{className:`${le.container} ${t??""}`,children:e.jsxs("div",{children:[e.jsx(J,{id:"calloutButton",icon:e.jsx(Ds,{}),disabled:s,onClick:G,children:"Manage file uploads"}),n&&e.jsxs(Ut,{role:"dialog",gapSpace:0,className:le.callout,target:"#calloutButton",onDismiss:()=>r(!1),setInitialFocus:!0,children:[e.jsx("form",{encType:"multipart/form-data",children:e.jsxs("div",{children:[e.jsx(Ot,{children:"Upload file:"}),e.jsx("input",{accept:".txt, .md, .json, .png, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html",className:le.chooseFiles,type:"file",onChange:me})]})}),a&&e.jsx(re,{children:"Uploading files..."}),!a&&y&&e.jsx(re,{children:y}),!a&&S&&e.jsx(re,{children:S.message}),e.jsx("h3",{children:"Previously uploaded files:"}),h&&e.jsx(re,{children:"Loading..."}),!h&&g.length===0&&e.jsx(re,{children:"No files uploaded yet"}),g.map((b,k)=>e.jsxs("div",{className:le.list,children:[e.jsx("div",{className:le.item,children:b}),e.jsxs(J,{icon:e.jsx(Mt,{}),onClick:()=>ve(b),disabled:u[b]==="pending"||u[b]==="success",children:[!u[b]&&"Delete file",u[b]=="pending"&&"Deleting file...",u[b]=="error"&&"Error deleting.",u[b]=="success"&&"File deleted"]})]},k))]})]})})},sa="_container_17evt_1",na={container:sa},T={promptTemplate:"Overrides the prompt used to generate the answer based on the question and search results. To append to existing prompt instead of replace whole prompt, start your prompt with '>>>'.",temperature:"Sets the temperature of the request to the LLM that generates the answer. Higher temperatures result in more creative responses, but they may be less grounded.",seed:"Sets a seed to improve the reproducibility of the model's responses. The seed can be any integer.",searchScore:"Sets a minimum score for search results coming back from Azure AI search. The score range depends on whether you're using hybrid (default), vectors only, or text only.",rerankerScore:"Sets a minimum score for search results coming back from the semantic reranker. The score always ranges between 0-4. The higher the score, the more semantically relevant the result is to the question.",retrieveNumber:"Sets the number of search results to retrieve from Azure AI search. More results may increase the likelihood of finding the correct answer, but may lead to the model getting 'lost in the middle'.",excludeCategory:"Specifies a category to exclude from the search results. There are no categories used in the default data set.",useSemanticReranker:"Enables the Azure AI Search semantic ranker, a model that re-ranks search results based on semantic similarity to the user's query.",useSemanticCaptions:"Sends semantic captions to the LLM instead of the full search result. A semantic caption is extracted from a search result during the process of semantic ranking.",suggestFollowupQuestions:"Asks the LLM to suggest follow-up questions based on the user's query.",useGPT4Vision:"Uses GPT-4-Turbo with Vision to generate responses based on images and text from the index.",vectorFields:"Specifies which embedding fields in the Azure AI Search Index will be searched, both the 'Images and text' embeddings, 'Images' only, or 'Text' only.",gpt4VisionInputs:"Sets what will be sent to the vision model. 'Images and text' sends both images and text to the model, 'Images' sends only images, and 'Text' sends only text.",retrievalMode:"Sets the retrieval mode for the Azure AI Search query. `Vectors + Text (Hybrid)` uses a combination of vector search and full text search, `Vectors` uses only vector search, and `Text` uses only full text search. Hybrid is generally optimal.",streamChat:"Continuously streams the response to the chat UI as it is generated.",useOidSecurityFilter:"Filter search results based on the authenticated user's OID.",useGroupsSecurityFilter:"Filter search results based on the authenticated user's groups."},oa=({updateRetrievalMode:t,updateVectorFields:s,showImageOptions:n,defaultRetrievalMode:r})=>{const[a,l]=i.useState(A.Hybrid),[h,c]=i.useState(M.Both),u=(g,x)=>{l(x?.data||A.Hybrid),t(x?.data||A.Hybrid)},p=(g,x)=>{c(x?.key),s([x?.key])};i.useEffect(()=>{s(n?[M.Embedding,M.ImageEmbedding]:[M.Embedding])},[n]);const S=m("retrievalMode"),_=m("retrievalModeField"),y=m("vectorFields"),w=m("vectorFieldsField");return e.jsxs(j,{className:na.container,tokens:{childrenGap:10},children:[e.jsx(Ue,{id:_,label:"Retrieval mode",selectedKey:r.toString(),options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:a==A.Hybrid,data:A.Hybrid},{key:"vectors",text:"Vectors",selected:a==A.Vectors,data:A.Vectors},{key:"text",text:"Text",selected:a==A.Text,data:A.Text}],required:!0,onChange:u,"aria-labelledby":S,onRenderLabel:g=>e.jsx(C,{labelId:S,fieldId:_,helpText:T.retrievalMode,label:g?.label})}),n&&[A.Vectors,A.Hybrid].includes(a)&&e.jsx(Ue,{id:w,label:"Vector fields (Multi-query vector search)",options:[{key:M.Embedding,text:"Text Embeddings",selected:h===M.Embedding},{key:M.ImageEmbedding,text:"Image Embeddings",selected:h===M.ImageEmbedding},{key:M.Both,text:"Text and Image embeddings",selected:h===M.Both}],onChange:p,"aria-labelledby":y,onRenderLabel:g=>e.jsx(C,{labelId:y,fieldId:w,helpText:T.vectorFields,label:g?.label})})]})},aa=()=>{const{instance:t}=he();t.getActiveAccount();const[s,n]=i.useState(void 0);i.useEffect(()=>{(async()=>{n(await Nn(t))})()},[]);const r=c=>typeof c=="string"?c:JSON.stringify(c),l=(c=>Object.keys(c??{}).map(u=>{let p=u;try{const _=new URL(u).pathname.split("/");u=_[_.length-1]}catch{}return{name:u,value:r((c??{})[p])}}))(s),h=[Lt({columnId:"name",compare:(c,u)=>c.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:c=>c.name}),Lt({columnId:"value",compare:(c,u)=>c.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:c=>c.value})];return e.jsxs("div",{children:[e.jsx(Ot,{children:"ID Token Claims"}),e.jsxs(Zs,{items:l,columns:h,sortable:!0,getRowId:c=>c.name,children:[e.jsx(en,{children:e.jsx(At,{children:({renderHeaderCell:c})=>e.jsx(tn,{children:c()})})}),e.jsx(sn,{children:({item:c,rowId:u})=>e.jsx(At,{children:({renderCell:p})=>e.jsx(nn,{children:p(c)})},u)})]})]})},ra="_container_17evt_1",ia={container:ra},la=({updateGPT4VInputs:t,updateUseGPT4V:s,isUseGPT4V:n,gpt4vInputs:r})=>{const[a,l]=i.useState(n),[h,c]=i.useState(r||D.TextAndImages),u=(g,x)=>{s(!!x),l(!!x)},p=(g,x)=>{if(x){const v=x.key;t(v||D.TextAndImages),v&&c(v)}};i.useEffect(()=>{a&&t(D.TextAndImages)},[a]);const S=m("useGPT4V"),_=m("useGPT4VField"),y=m("gpt4VInput"),w=m("gpt4VInputField");return e.jsxs(j,{className:ia.container,tokens:{childrenGap:10},children:[e.jsx(Q,{id:_,checked:a,label:"Use GPT vision model",onChange:u,"aria-labelledby":S,onRenderLabel:g=>e.jsx(C,{labelId:S,fieldId:_,helpText:T.useGPT4Vision,label:g?.label})}),a&&e.jsx(Ue,{id:w,selectedKey:h,label:"GPT vision model inputs",options:[{key:D.TextAndImages,text:"Images and text"},{text:"Images",key:D.Images},{text:"Text",key:D.Texts}],required:!0,onChange:p,"aria-labelledby":y,onRenderLabel:g=>e.jsx(C,{labelId:y,fieldId:w,helpText:T.gpt4VisionInputs,label:g?.label})})]})},ca=()=>{const[t,s]=i.useState(!1),[n,r]=i.useState(""),[a,l]=i.useState(.3),[h,c]=i.useState(null),[u,p]=i.useState(0),[S,_]=i.useState(0),[y,w]=i.useState(3),[g,x]=i.useState(A.Hybrid),[v,G]=i.useState(!0),[U,ve]=i.useState(!0),[me,b]=i.useState(!1),[k,ge]=i.useState(""),[O,Ce]=i.useState(!1),[Gt,$t]=i.useState([M.Embedding]),[Ve,Dt]=i.useState(!1),[Ge,Ht]=i.useState(!1),[$e,zt]=i.useState(D.TextAndImages),[xe,Qt]=i.useState(!1),H=i.useRef(""),Te=i.useRef(null),[fe,be]=i.useState(!1),[De,Ie]=i.useState(!1),[Se,ke]=i.useState(),[He,Le]=i.useState(),[ee,X]=i.useState(void 0),[te,ze]=i.useState(0),[I,Ae]=i.useState([]),[Qe,Ke]=i.useState([]),[se,Kt]=i.useState([]),[We,Wt]=i.useState(!1),[Je,Jt]=i.useState(!1),[Xt,Yt]=i.useState(!1),[Zt,es]=i.useState(!1),[ts,ss]=i.useState(!1),[Xe,ns]=i.useState(!1),[Ne,os]=i.useState(!1),as=async()=>{Fn().then(o=>{Wt(o.showGPT4VOptions),G(o.showSemanticRankerOption),Jt(o.showSemanticRankerOption),Yt(o.showVectorOption),o.showVectorOption||x(A.Text),es(o.showUserUpload),ss(o.showSpeechInput),ns(o.showSpeechOutputBrowser),os(o.showSpeechOutputAzure)})},rs=async(o,d,P)=>{let ae="",F={};const q=R=>new Promise(ws=>{setTimeout(()=>{ae+=R;const js={...F,message:{content:ae,role:F.message.role}};Ke([...d,[o,js]]),ws(null)},33)});try{Ie(!0);for await(const R of Ls(P))if(R.context&&R.context.data_points)R.message=R.delta,F=R;else if(R.delta.content)be(!1),await q(R.delta.content);else if(R.context)F.context={...F.context,...R.context};else if(R.error)throw Error(R.error)}finally{Ie(!1)}return{...F,message:{content:ae,role:F.message.role}}},Ye=he().instance,{loggedIn:Fe}=i.useContext(je),ne=async o=>{H.current=o,Se&&ke(void 0),be(!0),Le(void 0),X(void 0);const d=Ye?await de(Ye):void 0;try{const ae={messages:[...I.flatMap(q=>[{content:q[0],role:"user"},{content:q[1].message.content,role:"assistant"}]),{content:o,role:"user"}],context:{overrides:{prompt_template:n.length===0?void 0:n,exclude_category:k.length===0?void 0:k,top:y,temperature:a,minimum_reranker_score:u,minimum_search_score:S,retrieval_mode:g,semantic_ranker:v,semantic_captions:me,suggest_followup_questions:O,use_oid_security_filter:Ve,use_groups_security_filter:Ge,vector_fields:Gt,use_gpt4v:xe,gpt4v_input:$e,...h!==null?{seed:h}:{}}},session_state:I.length?I[I.length-1][1].session_state:null},F=await Rn(ae,U,d);if(!F.body)throw Error("No response body");if(U){const q=await rs(o,I,F.body);Ae([...I,[o,q]])}else{const q=await F.json();if(F.status>299||!F.ok)throw Error(q.error||"Unknown error");Ae([...I,[o,q]])}}catch(P){ke(P)}finally{be(!1)}},is=()=>{H.current="",Se&&ke(void 0),Le(void 0),X(void 0),Ae([]),Ke([]),be(!1),Ie(!1)};i.useEffect(()=>Te.current?.scrollIntoView({behavior:"smooth"}),[fe]),i.useEffect(()=>Te.current?.scrollIntoView({behavior:"auto"}),[Qe]),i.useEffect(()=>{as()},[]),i.useEffect(()=>{if(I&&Ne)for(let o=0;o<I.length;o++)se[o]||Pn(I[o][1].message.content).then(d=>{Kt([...se.slice(0,o),d,...se.slice(o+1)])})},[I]);const ls=(o,d)=>{r(d||"")},cs=(o,d)=>{l(parseFloat(d||"0"))},ds=(o,d)=>{c(parseInt(d||""))},us=(o,d)=>{_(parseFloat(d||"0"))},hs=(o,d)=>{p(parseFloat(d||"0"))},ps=(o,d)=>{w(parseInt(d||"3"))},ms=(o,d)=>{G(!!d)},gs=(o,d)=>{b(!!d)},xs=(o,d)=>{ve(!!d)},fs=(o,d)=>{ge(d||"")},bs=(o,d)=>{Ce(!!d)},Ss=(o,d)=>{Dt(!!d)},_s=(o,d)=>{Ht(!!d)},ys=o=>{ne(o)},Ze=(o,d)=>{He===o&&ee===B.CitationTab&&te===d?X(void 0):(Le(o),X(B.CitationTab)),ze(d)},oe=(o,d)=>{X(ee===o&&te===d?void 0:o),ze(d)},et=m("promptTemplate"),tt=m("promptTemplateField"),st=m("temperature"),nt=m("temperatureField"),ot=m("seed"),at=m("seedField"),rt=m("searchScore"),it=m("searchScoreField"),lt=m("rerankerScore"),ct=m("rerankerScoreField"),dt=m("retrieveCount"),ut=m("retrieveCountField"),ht=m("excludeCategory"),pt=m("excludeCategoryField"),mt=m("semanticRanker"),gt=m("semanticRankerField"),xt=m("semanticCaptions"),ft=m("semanticCaptionsField"),bt=m("suggestFollowupQuestions"),St=m("suggestFollowupQuestionsField"),_t=m("useOidSecurityFilter"),yt=m("useOidSecurityFilterField"),wt=m("useGroupsSecurityFilter"),jt=m("useGroupsSecurityFilterField"),vt=m("shouldStream"),Ct=m("shouldStreamField");return e.jsxs("div",{className:f.container,children:[e.jsxs("div",{className:f.commandsContainer,children:[e.jsx(Jo,{className:f.commandButton,onClick:is,disabled:!H.current||fe}),Zt&&e.jsx(ta,{className:f.commandButton,disabled:!Fe}),e.jsx(Qo,{className:f.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:f.chatRoot,children:[e.jsxs("div",{className:f.chatContainer,children:[H.current?e.jsxs("div",{className:f.chatMessageStream,children:[De&&Qe.map((o,d)=>e.jsxs("div",{children:[e.jsx(ye,{message:o[0]}),e.jsx("div",{className:f.chatMessageGpt,children:e.jsx(Ft,{isStreaming:!0,answer:o[1],isSelected:!1,onCitationClicked:P=>Ze(P,d),onThoughtProcessClicked:()=>oe(B.ThoughtProcessTab,d),onSupportingContentClicked:()=>oe(B.SupportingContentTab,d),onFollowupQuestionClicked:P=>ne(P),showFollowupQuestions:O&&I.length-1===d,showSpeechOutputAzure:Ne,showSpeechOutputBrowser:Xe,speechUrl:se[d]},d)})]},d)),!De&&I.map((o,d)=>e.jsxs("div",{children:[e.jsx(ye,{message:o[0]}),e.jsx("div",{className:f.chatMessageGpt,children:e.jsx(Ft,{isStreaming:!1,answer:o[1],isSelected:te===d&&ee!==void 0,onCitationClicked:P=>Ze(P,d),onThoughtProcessClicked:()=>oe(B.ThoughtProcessTab,d),onSupportingContentClicked:()=>oe(B.SupportingContentTab,d),onFollowupQuestionClicked:P=>ne(P),showFollowupQuestions:O&&I.length-1===d,showSpeechOutputAzure:Ne,showSpeechOutputBrowser:Xe,speechUrl:se[d]},d)})]},d)),fe&&e.jsxs(e.Fragment,{children:[e.jsx(ye,{message:H.current}),e.jsx("div",{className:f.chatMessageGptMinWidth,children:e.jsx(so,{})})]}),Se?e.jsxs(e.Fragment,{children:[e.jsx(ye,{message:H.current}),e.jsx("div",{className:f.chatMessageGptMinWidth,children:e.jsx(no,{error:Se.toString(),onRetry:()=>ne(H.current)})})]}):null,e.jsx("div",{ref:Te})]}):e.jsxs("div",{className:f.chatEmptyState,children:[e.jsx("h1",{className:f.chatEmptyStateTitle,children:"Chat with Fernie your  Fernwood  Assistant"}),e.jsx("h2",{className:f.chatEmptyStateSubtitle,children:"Ask Fernie anything, try an example below"}),e.jsx(fo,{onExampleClicked:ys,useGPT4V:xe})]}),e.jsx("div",{className:f.chatInput,children:e.jsx(co,{clearOnSend:!0,placeholder:"Type a new question (e.g. does my plan cover annual eye exams?)",disabled:fe,onSend:o=>ne(o),showSpeechInput:ts})})]}),I.length>0&&ee&&e.jsx(Do,{className:f.chatAnalysisPanel,activeCitation:He,onActiveTabChanged:o=>oe(o,te),citationHeight:"810px",answer:I[te][1],activeTab:ee}),e.jsxs(on,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(qe,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx($,{id:tt,className:f.chatSettingsSeparator,defaultValue:n,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:ls,"aria-labelledby":et,onRenderLabel:o=>e.jsx(C,{labelId:et,fieldId:tt,helpText:T.promptTemplate,label:o?.label})}),e.jsx($,{id:nt,className:f.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:a.toString(),onChange:cs,"aria-labelledby":st,onRenderLabel:o=>e.jsx(C,{labelId:st,fieldId:nt,helpText:T.temperature,label:o?.label})}),e.jsx($,{id:at,className:f.chatSettingsSeparator,label:"Seed",type:"text",defaultValue:h?.toString()||"",onChange:ds,"aria-labelledby":ot,onRenderLabel:o=>e.jsx(C,{labelId:ot,fieldId:at,helpText:T.seed,label:o?.label})}),e.jsx($,{id:it,className:f.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:S.toString(),onChange:us,"aria-labelledby":rt,onRenderLabel:o=>e.jsx(C,{labelId:rt,fieldId:it,helpText:T.searchScore,label:o?.label})}),Je&&e.jsx($,{id:ct,className:f.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:u.toString(),onChange:hs,"aria-labelledby":lt,onRenderLabel:o=>e.jsx(C,{labelId:lt,fieldId:ct,helpText:T.rerankerScore,label:o?.label})}),e.jsx($,{id:ut,className:f.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:y.toString(),onChange:ps,"aria-labelledby":dt,onRenderLabel:o=>e.jsx(C,{labelId:dt,fieldId:ut,helpText:T.retrieveNumber,label:o?.label})}),e.jsx($,{id:pt,className:f.chatSettingsSeparator,label:"Exclude category",defaultValue:k,onChange:fs,"aria-labelledby":ht,onRenderLabel:o=>e.jsx(C,{labelId:ht,fieldId:pt,helpText:T.excludeCategory,label:o?.label})}),Je&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:gt,className:f.chatSettingsSeparator,checked:v,label:"Use semantic ranker for retrieval",onChange:ms,"aria-labelledby":mt,onRenderLabel:o=>e.jsx(C,{labelId:mt,fieldId:gt,helpText:T.useSemanticReranker,label:o?.label})}),e.jsx(Q,{id:ft,className:f.chatSettingsSeparator,checked:me,label:"Use semantic captions",onChange:gs,disabled:!v,"aria-labelledby":xt,onRenderLabel:o=>e.jsx(C,{labelId:xt,fieldId:ft,helpText:T.useSemanticCaptions,label:o?.label})})]}),e.jsx(Q,{id:St,className:f.chatSettingsSeparator,checked:O,label:"Suggest follow-up questions",onChange:bs,"aria-labelledby":bt,onRenderLabel:o=>e.jsx(C,{labelId:bt,fieldId:St,helpText:T.suggestFollowupQuestions,label:o?.label})}),We&&e.jsx(la,{gpt4vInputs:$e,isUseGPT4V:xe,updateUseGPT4V:o=>{Qt(o)},updateGPT4VInputs:o=>zt(o)}),Xt&&e.jsx(oa,{defaultRetrievalMode:g,showImageOptions:xe&&We,updateVectorFields:o=>$t(o),updateRetrievalMode:o=>x(o)}),e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:yt,className:f.chatSettingsSeparator,checked:Ve||ce,label:"Use oid security filter",disabled:!Fe||ce,onChange:Ss,"aria-labelledby":_t,onRenderLabel:o=>e.jsx(C,{labelId:_t,fieldId:yt,helpText:T.useOidSecurityFilter,label:o?.label})}),e.jsx(Q,{id:jt,className:f.chatSettingsSeparator,checked:Ge||ce,label:"Use groups security filter",disabled:!Fe||ce,onChange:_s,"aria-labelledby":wt,onRenderLabel:o=>e.jsx(C,{labelId:wt,fieldId:jt,helpText:T.useGroupsSecurityFilter,label:o?.label})})]}),e.jsx(Q,{id:Ct,className:f.chatSettingsSeparator,checked:U,label:"Stream chat completion responses",onChange:xs,"aria-labelledby":vt,onRenderLabel:o=>e.jsx(C,{labelId:vt,fieldId:Ct,helpText:T.streamChat,label:o?.label})}),e.jsx(aa,{})]})]})]})},da="_layout_1hqcj_1",ua="_header_1hqcj_13",ha="_headerContainer_1hqcj_23",pa="_headerTitleContainer_1hqcj_41",ma="_headerLogo_1hqcj_55",ga="_headerTitle_1hqcj_41",xa="_headerNavList_1hqcj_75",fa="_show_1hqcj_105",ba="_headerNavPageLink_1hqcj_115",Sa="_headerNavPageLinkActive_1hqcj_149",_a="_headerNavLeftMargin_1hqcj_165",ya="_microsoftLogo_1hqcj_173",wa="_githubLogo_1hqcj_175",ja="_menuToggle_1hqcj_183",va="_loginMenuContainer_1hqcj_203",Ca="_headerRightText_1hqcj_283",E={layout:da,header:ua,headerContainer:ha,headerTitleContainer:pa,headerLogo:ma,headerTitle:ga,headerNavList:xa,show:fa,headerNavPageLink:ba,headerNavPageLinkActive:Sa,headerNavLeftMargin:_a,microsoftLogo:ya,githubLogo:wa,menuToggle:ja,loginMenuContainer:va,headerRightText:Ca},Ta="_loginButton_1njer_1",Ia={loginButton:Ta},ka=()=>{const{instance:t}=he(),{loggedIn:s,setLoggedIn:n}=i.useContext(je),r=t.getActiveAccount(),[a,l]=i.useState("");i.useEffect(()=>{(async()=>{l(await Pe(t)??"")})()},[]);const h=()=>{t.loginPopup({...In,redirectUri:Bt()}).catch(u=>console.log(u)).then(async()=>{n(await Oe(t)),l(await Pe(t)??"")})},c=()=>{r?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(u=>console.log(u)).then(async()=>{n(await Oe(t)),l(await Pe(t)??"")}):An()};return e.jsx(qe,{text:s?`Logout
${a}`:"Login",className:Ia.loginButton,onClick:s?c:h})},La="/assets/frenwood-39e253c4.png",Aa=()=>{const[t,s]=i.useState(!1),n=i.useRef(null),r=()=>{s(!t)},a=l=>{n.current&&!n.current.contains(l.target)&&s(!1)};return i.useEffect(()=>(t?document.addEventListener("mousedown",a):document.removeEventListener("mousedown",a),()=>{document.removeEventListener("mousedown",a)}),[t]),e.jsxs("div",{className:E.layout,children:[e.jsx("header",{className:E.header,role:"banner",children:e.jsxs("div",{className:E.headerContainer,ref:n,children:[e.jsx(As,{to:"/",className:E.headerTitleContainer,children:e.jsx("img",{src:La,alt:"Logo",style:{width:"50%",height:"100%",marginLeft:"10px",padding:"10px"}})}),e.jsx("nav",{children:e.jsxs("ul",{className:`${E.headerNavList} ${t?E.show:""}`,children:[e.jsx("li",{children:e.jsx(Tt,{to:"/",className:({isActive:l})=>l?E.headerNavPageLinkActive:E.headerNavPageLink,onClick:()=>s(!1),children:"Chat"})}),e.jsx("li",{children:e.jsx(Tt,{to:"/qa",className:({isActive:l})=>l?E.headerNavPageLinkActive:E.headerNavPageLink,onClick:()=>s(!1),children:"Ask a question"})})]})}),e.jsxs("div",{className:E.loginMenuContainer,children:[e.jsx(ka,{}),e.jsx(W,{iconProps:{iconName:"GlobalNavButton"},className:E.menuToggle,onClick:r,ariaLabel:"Toggle menu"})]})]})}),e.jsx(Ns,{})]})},Na=()=>{const[t,s]=i.useState(!1);{var n=new Fs(Tn);return!n.getActiveAccount()&&n.getAllAccounts().length>0&&n.setActiveAccount(n.getActiveAccount()),n.addEventCallback(r=>{if(r.eventType===Rs.LOGIN_SUCCESS&&r.payload){const a=r.payload;n.setActiveAccount(a)}}),i.useEffect(()=>{(async()=>{s(await Oe(n))})()},[]),e.jsx(Ps,{instance:n,children:e.jsx(je.Provider,{value:{loggedIn:t,setLoggedIn:s},children:e.jsx(Aa,{})})})}};Es();const Fa=Ms([{path:"/",element:e.jsx(Na,{}),children:[{index:!0,element:e.jsx(ca,{})},{path:"qa",lazy:()=>It(()=>import("./Ask-c8e3f689.js"),["assets/Ask-c8e3f689.js","assets/vendor-5ba33fe3.js","assets/fluentui-react-af2542d5.js","assets/fluentui-icons-8f811f5c.js","assets/Ask-fb3fe69f.css"])},{path:"*",lazy:()=>It(()=>import("./NoPage-0f437e6f.js"),["assets/NoPage-0f437e6f.js","assets/vendor-5ba33fe3.js"])}]}]);Us.createRoot(document.getElementById("root")).render(e.jsx(Os.StrictMode,{children:e.jsx(Bs,{router:Fa})}));export{Ft as A,fo as E,D as G,C as H,je as L,co as Q,A as R,Qo as S,aa as T,ta as U,M as V,B as a,no as b,Do as c,la as d,oa as e,Fn as f,Pn as g,de as h,Ua as i,ce as r,T as t};
//# sourceMappingURL=index-38720978.js.map
