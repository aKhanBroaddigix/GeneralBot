import{r as s,bI as ut,bC as t}from"./vendor-7b019978.js";import{R as Ce,G as pt,V as ke,L as mt,g as St,U as ht,S as bt,Q as gt,E as xt,A as Ct,a as S,b as kt,c as It,H as r,t as l,d as _t,e as yt,r as h,T as Tt,f as ft,h as vt,i as Ft}from"./index-2697d6c3.js";import{b as n,c as jt,s as wt,D as Rt,a as c,r as b}from"./fluentui-react-3c98b5a1.js";import"./fluentui-icons-0b8131c0.js";const At="_askContainer_497rq_1",Ot="_askTopSection_497rq_15",Pt="_askBottomSection_497rq_29",Vt="_askTitle_497rq_49",Ut="_askQuestionInput_497rq_61",Nt="_askAnswerContainer_497rq_73",Bt="_askAnalysisPanel_497rq_87",Gt="_askSettingsSeparator_497rq_97",Lt="_settingsButton_497rq_109",Et="_commandsContainer_497rq_121",qt="_commandButton_497rq_135",o={askContainer:At,askTopSection:Ot,askBottomSection:Pt,askTitle:Vt,askQuestionInput:Ut,askAnswerContainer:Nt,askAnalysisPanel:Bt,askSettingsSeparator:Gt,settingsButton:Lt,commandsContainer:Et,commandButton:qt};function Mt(){const[j,g]=s.useState(!1),[x,Ie]=s.useState(""),[w,Qt]=s.useState(""),[R,Dt]=s.useState(""),[A,_e]=s.useState(.3),[C,ye]=s.useState(null),[O,Te]=s.useState(0),[P,fe]=s.useState(0),[V,U]=s.useState(Ce.Hybrid),[N,ve]=s.useState(3),[k,B]=s.useState(!0),[G,Fe]=s.useState(!1),[u,je]=s.useState(!1),[L,we]=s.useState(pt.TextAndImages),[I,Re]=s.useState(""),[Ae,Oe]=s.useState(""),[Pe,Ve]=s.useState([ke.Embedding,ke.ImageEmbedding]),[E,Ue]=s.useState(!1),[q,Ne]=s.useState(!1),[M,Be]=s.useState(!1),[Q,Ge]=s.useState(!1),[Le,Ee]=s.useState(!1),[qe,Me]=s.useState(!1),[Qe,De]=s.useState(!1),[He,ze]=s.useState(!1),[D,Je]=s.useState(!1),_=s.useRef(""),[y,H]=s.useState(!1),[p,z]=s.useState(),[i,Ke]=s.useState(),[We,J]=s.useState(null),[K,W]=s.useState(),[m,d]=s.useState(void 0),X=ut().instance,{loggedIn:T}=s.useContext(mt),Xe=async()=>{ft().then(e=>{Be(e.showGPT4VOptions),B(e.showSemanticRankerOption),Ge(e.showSemanticRankerOption),Ee(e.showVectorOption),e.showVectorOption||U(Ce.Text),Me(e.showUserUpload),De(e.showSpeechInput),ze(e.showSpeechOutputBrowser),Je(e.showSpeechOutputAzure)})};s.useEffect(()=>{Xe()},[]),s.useEffect(()=>{i&&D&&St(i.message.content).then(e=>{J(e)})},[i]);const f=async e=>{_.current=e,p&&z(void 0),H(!0),W(void 0),d(void 0);const a=X?await vt(X):void 0;try{const F={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:x.length===0?void 0:x,prompt_template_prefix:w.length===0?void 0:w,prompt_template_suffix:R.length===0?void 0:R,exclude_category:I.length===0?void 0:I,top:N,temperature:A,minimum_reranker_score:O,minimum_search_score:P,retrieval_mode:V,semantic_ranker:k,semantic_captions:G,use_oid_security_filter:E,use_groups_security_filter:q,vector_fields:Pe,use_gpt4v:u,gpt4v_input:L,...C!==null?{seed:C}:{}}},session_state:i?i.session_state:null},dt=await Ft(F,a);Ke(dt),J(null)}catch(F){z(F)}finally{H(!1)}},Ye=(e,a)=>{Ie(a||"")},Ze=(e,a)=>{_e(parseFloat(a||"0"))},$e=(e,a)=>{ye(parseInt(a||""))},et=(e,a)=>{fe(parseFloat(a||"0"))},tt=(e,a)=>{Te(parseFloat(a||"0"))},st=(e,a)=>{ve(parseInt(a||"3"))},at=(e,a)=>{B(!!a)},nt=(e,a)=>{Fe(!!a)},ot=(e,a)=>{Re(a||"")},rt=e=>{f(e),Oe(e)},lt=e=>{K===e&&m===S.CitationTab?d(void 0):(W(e),d(S.CitationTab))},v=e=>{d(m===e?void 0:e)},it=(e,a)=>{Ue(!!a)},ct=(e,a)=>{Ne(!!a)},Y=n("promptTemplate"),Z=n("promptTemplateField"),$=n("temperature"),ee=n("temperatureField"),te=n("seed"),se=n("seedField"),ae=n("searchScore"),ne=n("searchScoreField"),oe=n("rerankerScore"),re=n("rerankerScoreField"),le=n("retrieveCount"),ie=n("retrieveCountField"),ce=n("excludeCategory"),de=n("excludeCategoryField"),ue=n("semanticRanker"),pe=n("semanticRankerField"),me=n("semanticCaptions"),Se=n("semanticCaptionsField"),he=n("useOidSecurityFilter"),be=n("useOidSecurityFilterField"),ge=n("useGroupsSecurityFilter"),xe=n("useGroupsSecurityFilterField");return t.jsxs("div",{className:o.askContainer,children:[t.jsxs("div",{className:o.askTopSection,children:[t.jsxs("div",{className:o.commandsContainer,children:[qe&&t.jsx(ht,{className:o.commandButton,disabled:T}),t.jsx(bt,{className:o.commandButton,onClick:()=>g(!j)})]}),t.jsx("h1",{className:o.askTitle,children:"Ask your data"}),t.jsx("div",{className:o.askQuestionInput,children:t.jsx(gt,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:y,initQuestion:Ae,onSend:e=>f(e),showSpeechInput:Qe})})]}),t.jsxs("div",{className:o.askBottomSection,children:[y&&t.jsx(jt,{label:"Just a moment and I'll check"}),!_.current&&t.jsx(xt,{onExampleClicked:rt,useGPT4V:u}),!y&&i&&!p&&t.jsx("div",{className:o.askAnswerContainer,children:t.jsx(Ct,{answer:i,isStreaming:!1,onCitationClicked:e=>lt(e),onThoughtProcessClicked:()=>v(S.ThoughtProcessTab),onSupportingContentClicked:()=>v(S.SupportingContentTab),showSpeechOutputAzure:D,showSpeechOutputBrowser:He,speechUrl:We})}),p?t.jsx("div",{className:o.askAnswerContainer,children:t.jsx(kt,{error:p.toString(),onRetry:()=>f(_.current)})}):null,m&&i&&t.jsx(It,{className:o.askAnalysisPanel,activeCitation:K,onActiveTabChanged:e=>v(e),citationHeight:"600px",answer:i,activeTab:m})]}),t.jsxs(wt,{headerText:"Configure answer generation",isOpen:j,isBlocking:!1,onDismiss:()=>g(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(Rt,{onClick:()=>g(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(c,{id:Z,className:o.chatSettingsSeparator,defaultValue:x,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:Ye,"aria-labelledby":Y,onRenderLabel:e=>t.jsx(r,{labelId:Y,fieldId:Z,helpText:l.promptTemplate,label:e?.label})}),t.jsx(c,{id:ee,className:o.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:A.toString(),onChange:Ze,"aria-labelledby":$,onRenderLabel:e=>t.jsx(r,{labelId:$,fieldId:ee,helpText:l.temperature,label:e?.label})}),t.jsx(c,{id:se,className:o.chatSettingsSeparator,label:"Seed",type:"text",defaultValue:C?.toString()||"",onChange:$e,"aria-labelledby":te,onRenderLabel:e=>t.jsx(r,{labelId:te,fieldId:se,helpText:l.seed,label:e?.label})}),t.jsx(c,{id:ne,className:o.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:P.toString(),onChange:et,"aria-labelledby":ae,onRenderLabel:e=>t.jsx(r,{labelId:ae,fieldId:ne,helpText:l.searchScore,label:e?.label})}),Q&&t.jsx(c,{id:re,className:o.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:O.toString(),onChange:tt,"aria-labelledby":oe,onRenderLabel:e=>t.jsx(r,{labelId:oe,fieldId:re,helpText:l.rerankerScore,label:e?.label})}),t.jsx(c,{id:ie,className:o.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:N.toString(),onChange:st,"aria-labelledby":le,onRenderLabel:e=>t.jsx(r,{labelId:le,fieldId:ie,helpText:l.retrieveNumber,label:e?.label})}),t.jsx(c,{id:de,className:o.chatSettingsSeparator,label:"Exclude category",defaultValue:I,onChange:ot,"aria-labelledby":ce,onRenderLabel:e=>t.jsx(r,{labelId:ce,fieldId:de,helpText:l.excludeCategory,label:e?.label})}),Q&&t.jsxs(t.Fragment,{children:[t.jsx(b,{id:pe,className:o.chatSettingsSeparator,checked:k,label:"Use semantic ranker for retrieval",onChange:at,"aria-labelledby":ue,onRenderLabel:e=>t.jsx(r,{labelId:ue,fieldId:pe,helpText:l.useSemanticReranker,label:e?.label})}),t.jsx(b,{id:Se,className:o.chatSettingsSeparator,checked:G,label:"Use semantic captions",onChange:nt,disabled:!k,"aria-labelledby":me,onRenderLabel:e=>t.jsx(r,{labelId:me,fieldId:Se,helpText:l.useSemanticCaptions,label:e?.label})})]}),M&&t.jsx(_t,{gpt4vInputs:L,isUseGPT4V:u,updateUseGPT4V:e=>{je(e)},updateGPT4VInputs:e=>we(e)}),Le&&t.jsx(yt,{defaultRetrievalMode:V,showImageOptions:u&&M,updateVectorFields:e=>Ve(e),updateRetrievalMode:e=>U(e)}),t.jsxs(t.Fragment,{children:[t.jsx(b,{id:be,className:o.chatSettingsSeparator,checked:E||h,label:"Use oid security filter",disabled:!T||h,onChange:it,"aria-labelledby":he,onRenderLabel:e=>t.jsx(r,{labelId:he,fieldId:be,helpText:l.useOidSecurityFilter,label:e?.label})}),t.jsx(b,{id:xe,className:o.chatSettingsSeparator,checked:q||h,label:"Use groups security filter",disabled:!T||h,onChange:ct,"aria-labelledby":ge,onRenderLabel:e=>t.jsx(r,{labelId:ge,fieldId:xe,helpText:l.useGroupsSecurityFilter,label:e?.label})})]}),t.jsx(Tt,{})]})]})}Mt.displayName="Ask";export{Mt as Component};
//# sourceMappingURL=Ask-c1f9813b.js.map
